<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.5">
    <title>Registro Dinner Educatori</title>
    <style>
        :root {
            --bg:#f0f2f5;
            --primary:#3984a7;
            --d1:#ff8000f8;
            --d2:#a333d1;
            --ok:#30ec80;
            --no:#ff0000;
            --wait:#3984a7;
        }
        body{font-family:'Segoe UI',sans-serif;background:var(--bg);padding:20px}
        .container{max-width:800px;margin:auto}
        
        header{
            background:var(--primary);
            color:#fff;
            padding:25px;
            border-radius:80px;
            text-align:center;
            margin-bottom:15px;
            box-shadow: 0 4px 10px #0000001a;
        }

        /* Stile Data e Orologio */
        #todayDate {
            font-size: 1.5em; /* Dimensione aumentata */
            font-weight: 500;
            margin-top: 8px;
            text-transform: capitalize;
            opacity: 0.9;
        }

        .clock-container {
            display: inline-block;
            margin-top: 15px;
            padding: 10px 30px;
            border-radius: 100px;
            transition: all 0.5s ease;
            box-shadow: inset 0 0 10px #00000033;
        }

        #digitalClock {
            font-family: 'Courier New', Courier, monospace;
            font-size: 2.5em;
            font-weight: bold;
        }

        /* Stati Orologio */
        .status-waiting { background: var(--wait); color: white; }
        .status-dinner1 { background: var(--d1); color: white; }
        .status-dinner2 { background: var(--no); color: white; }
        
        /* Box Giorni Settimana */
        .days-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        .day-box {
            background: #fff;
            padding: 10px;
            text-align: center;
            border-radius: 50px;
            font-size: 0.9em;
            color: #b90000;
            border: 2px solid transparent;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .day-box.active-day {
            border-color: var(--primary);
            background: #eef2ff;
            color: var(--primary);
            font-weight: bold;
        }

        .controls{background:#ffffff;padding:20px;border-radius:60px;margin-bottom:20px;box-shadow: 0 2px 5px rgba(0,0,0,0.1)}
        
        /* Cerca e Reset */
        .search-container { display: flex; gap: 10px; margin-bottom: 15px; }
        #searchInput { flex: 1; padding: 12px; border: 1px solid #cccccc; border-radius: 50px; }
        .btn-clear { background: #95a5a6; color: white; border: none; padding: 0 15px; border-radius: 50px; cursor: pointer; font-weight: bold; }

        .btn-group{display:flex;gap:10px;justify-content:center;margin-bottom:15px}
        .btn{padding:10px 20px;border:none;border-radius:50px;color:#ffffff;font-weight:bold;cursor:pointer; transition: 0.2s}
        .d1{background:var(--d1);opacity:.6}
        .d2{background:var(--d2);opacity:.6}
        .btn.active{opacity:1; transform: scale(1.05)}
        
        .filter-tags{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin-bottom:15px}
        .tag{padding:5px 12px;background:#dfe6e9;border-radius:200px;cursor:pointer;font-size: 1.1em}
        .tag.active{background:var(--primary);color:#ffffff}

        /* Contatore Totale */
        .counter-banner {
            background: #3984a7; color: white; padding: 15px; border-radius: 80px;
            text-align: center; margin-bottom: 15px; display: flex; justify-content: space-around;
        }
        .counter-item { display: flex; flex-direction: column; }
        .counter-num { font-size: 1.4em; font-weight: bold; color: var(--ok); }

        .student-row{
            background:#fff;margin-bottom:6px;padding:15px;border-radius:80px;
            display:flex;justify-content:space-between;align-items:center;
            border-left:10px solid var(--ok);cursor:pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .student-row.assente{border-left-color:var(--no);background:#fdf2f2}
        .student-row.assente .name{text-decoration:line-through;color:#999}
        .group-badge { font-size: 1.0em; background: #eee; padding: 2px 6px; border-radius: 30px; margin-left: 8px; color: #666; }
    </style>
</head>

<body>
<div class="container">
    <header>
        <h1>Registro Dinner</h1>
        <div id="todayDate"></div>
        <div class="clock-container status-waiting">
            <div id="digitalClock">00:00:00</div>
        </div>
    </header>

    <div class="days-container" id="daysHeader">
        <div class="day-box" id="day-1">LUN <br>2IeFP<br>PERMESSI: Tessarin no dinner; Casalicchio h 18; Pignatelli, Menaldino, Chessa h 20</div>
        <div class="day-box" id="day-2">MAR <br>5A, 5B gr1/gr2<br> PERMESSI: Chen, Commod, Epicoco no dinner; Casalicchio, Clerin h 18; Lazier h 20</div>
        <div class="day-box" id="day-3">MER<br> 2B<br>PERMESSI: Berruti S., D'Agostino, Epicoco, Giovannelli P. no dinner; Casalicchio h 18; Saitta h 19; Pignatelli, Chessa h 20</div>
        <div class="day-box" id="day-4">GIO<br> 2A<br>PERMESSI: Berruti A., Chen, Epicoco no dinner; Casalicchio, Clerin h 18; Menaldino, Lunardi, Chessa h 20</div>
    </div>

    <div class="counter-banner">
        <div class="counter-item"><span>18:30</span><span class="counter-num" id="count1">0</span></div>
        <div class="counter-item"><span>19:15</span><span class="counter-num" id="count2">0</span></div>
        <div class="counter-item"><span>TOTALE</span><span class="counter-num" style="color:#fff" id="countTot">0</span></div>
    </div>

    <div class="controls">
        <div class="search-container">
            <input id="searchInput" placeholder="Cerca studente o classe..." onkeyup="applicaFiltri()">
            <button class="btn-clear" onclick="resetRicerca()">CANCELLA</button>
        </div>
        <div class="btn-group">
            <button class="btn d1" id="btn-d1" onclick="setTurno(1)">18:30</button>
            <button class="btn d2" id="btn-d2" onclick="setTurno(2)">19:15</button>
        </div>
        <div class="filter-tags" id="tagList">
            <div class="tag active" id="tag-all" onclick="setClasse('Tutte')">Tutte</div>
        </div>
        <button class="btn" style="background:#689e4b;width:100%; font-size: 1.0em; padding: 15px;" onclick="generaPopUpStampa()">üìù RIEPILOGO</button>
    </div>

    <div id="listaStudenti"></div>
</div>

<script>
    const TURNI_BASE={ 1:['1A','1B','1P','2A','2B','2P','3P'], 2:['3A','3B','3C','4A','4B','5A','5B'] };
    const OVERRIDE_TURNO_2=['TEBANO'];
    const ASSENTI_CLASSI={ 1:['2P'], 2:['5A','5B'], 3:['2B'], 4:['2A'] };
    const ASSENTI_PERMESSO={
        1:['TESSARIN','CASALICCHIO','PIGNATELLI','MENALDINO','CHESSA'],
        2:['CHEN','COMMOD','EPICOCO','CASALICCHIO','CLERIN','LAZIER'],
        3:['BERRUTI S.','DAGOSTINO','EPICOCO','GIOVANNELLI P.','CASALICCHIO','SAITTA','PIGNATELLI','CHESSA'],
        4:['BERRUTI A.','CHEN','EPICOCO','CASALICCHIO','CLERIN','MENALDINO','LUNARDI','CHESSA']
    };

    const CALENDARIO_GRUPPI = {
        "20/01/2026": "gr1", "27/01/2026": "gr2", "03/02/2026": "gr1", "10/02/2026": "gr2" 
        // Aggiungi qui le altre date se necessario
    };

     const studenti=[ 
        { cognome: "COMMOD", nome: "Gaia", classe: "1A" },
        { cognome: "GASPARD", nome: "Thierry", classe: "1A" },
        { cognome: "JANS", nome: "Giada", classe: "1A" },
        { cognome: "OBETTI", nome: "Virginia", classe: "1A" },
        { cognome: "PETTORALI", nome: "Matilde", classe: "1A" },
        { cognome: "ZIGGIOTTO", nome: "Beatrice", classe: "1A" },
        { cognome: "BLANCHET", nome: "Nadine", classe: "1B" },
        { cognome: "BOMBONATO", nome: "Francesco", classe: "1B" },
        { cognome: "DATTRINO", nome: "Nicolas", classe: "1B" },
        { cognome: "GIOVANDO", nome: "Caterina", classe: "1B" },
        { cognome: "LUNARDI", nome: "Filippo", classe: "1B" },
        { cognome: "POUJOL", nome: "Chiara", classe: "1B" },
        { cognome: "QUERIO GIANETTO", nome: "Giorgio", classe: "1B" },
        { cognome: "SALVI", nome: "Sophie", classe: "1B" },
        { cognome: "SCHIRRU", nome: "Didier F√©licien Herv√©", classe: "1B" },
        { cognome: "VILARDO", nome: "Gabriele", classe: "1B" },
        { cognome: "BOUKHRIS", nome: "Chams Jacopo", classe: "1P" },
        { cognome: "CHABLOZ", nome: "Annette", classe: "1P" },
        { cognome: "DAGOSTINO", nome: "Domenico", classe: "1P" },
        { cognome: "FURLAN", nome: "Alessandro", classe: "1P" },
        { cognome: "GIOVANNELLI P.", nome: "Pietro", classe: "1P" },
        { cognome: "GUIZZETTI RINCON", nome: "Francisco Andres", classe: "1P" },
        { cognome: "LAI", nome: "Stefano", classe: "1P" },
        { cognome: "LAZIER", nome: "Francesco", classe: "1P" },
        { cognome: "PAONESSA", nome: "Leonardo", classe: "1P" },
        { cognome: "VINCENT", nome: "Thomas", classe: "1P" },
        { cognome: "RUSCI DI LUCA", nome: "Greta", classe: "1P" },
        { cognome: "SILVANI", nome: "Amelie", classe: "1P" },
        { cognome: "BARAVALLE", nome: "Andrea", classe: "2A" },
        { cognome: "BERTOT", nome: "Manuele", classe: "2A" },
        { cognome: "BUZZI", nome: "Alessandro", classe: "2A" },
        { cognome: "CASTELLANO", nome: "Martina", classe: "2A" },
        { cognome: "DA FRE", nome: "Gaia", classe: "2A" },
        { cognome: "DE GASPER", nome: "Lara", classe: "2A" },
        { cognome: "GARCIA", nome: "Luis Alberto", classe: "2A" },
        { cognome: "HERESAZ", nome: "Alyce", classe: "2A" },
        { cognome: "PENNARD", nome: "Serena", classe: "2A" },
        { cognome: "SAITTA", nome: "Asia", classe: "2A" },
        { cognome: "CHEN", nome: "Michael Jianhao", classe: "2B" },
        { cognome: "DELL'AQUILA", nome: "Gabriele", classe: "2B" },
        { cognome: "DUNAND", nome: "Audrey", classe: "2B" },
        { cognome: "GHILARDINI", nome: "Leonardo", classe: "2B" },
        { cognome: "MAINO", nome: "Giada", classe: "2B" },
        { cognome: "MISERENDINO", nome: "Ludovica", classe: "2B" },
        { cognome: "MOUNIM", nome: "Yahya", classe: "2B" },
        { cognome: "PEZZOLI", nome: "Niccol√≤", classe: "2B" },
        { cognome: "TACCONE", nome: "Nicholas", classe: "2B" },
        { cognome: "BERRIAD", nome: "Thierry", classe: "2P" },
        { cognome: "BERRUTI A.", nome: "Andrea", classe: "2P" },
        { cognome: "BERRUTI S.", nome: "Stefano", classe: "2P" },
        { cognome: "CASALICCHIO", nome: "Nahuel", classe: "2P" },
        { cognome: "CLERIN", nome: "Pietro", classe: "2P" },
        { cognome: "DONZEL", nome: "Elodie", classe: "2P" },
        { cognome: "GENS", nome: "Aaron", classe: "2P" },
        { cognome: "HERRERA", nome: "Alexander", classe: "2P" },
        { cognome: "MONTERO", nome: "Karen", classe: "2P" },
        { cognome: "PERRIN", nome: "Annie", classe: "2P" },
        { cognome: "STEVENIN", nome: "Joelle", classe: "2P" },
        { cognome: "TORTORELLI C.", nome: "Carlotta", classe: "2P" },
        { cognome: "TORTORELLI G.", nome: "Greta", classe: "2P" },
        { cognome: "CONSOL", nome: "Gaia", classe: "3P" },
        { cognome: "COSTANZA", nome: "Marcello", classe: "3P" },
        { cognome: "LAGOMARSINI", nome: "Michele", classe: "3P" },
        { cognome: "LLESHI", nome: "Gabriele", classe: "3P" },
        { cognome: "MARRERO", nome: "Lewis", classe: "3P" },
        { cognome: "RONCO", nome: "Angelica", classe: "3P" },
        { cognome: "CATTARINUSSI", nome: "Samuele", classe: "3A" },
        { cognome: "FLORIAN", nome: "Gabriele", classe: "3A" },
        { cognome: "MARANGELO", nome: "Giulio", classe: "3A" },
        { cognome: "PEAQUIN", nome: "Linda", classe: "3A" },
        { cognome: "ZOPPO", nome: "Rodrigue", classe: "3A" },
        { cognome: "BLANCHET", nome: "Magalie", classe: "3B" },
        { cognome: "BOGGIA", nome: "Vittoria", classe: "3B" },
        { cognome: "CIRINA", nome: "Lorenzo", classe: "3B" },
        { cognome: "DUBLANC", nome: "Nicole", classe: "3B" },
        { cognome: "GRANATA", nome: "Gabriele", classe: "3B" },
        { cognome: "PRUTEANU", nome: "Mihai Giuliano", classe: "3B" },
        { cognome: "TRIOLO", nome: "Eleonora", classe: "3B" },
        { cognome: "CELESIA M.", nome: "Marta", classe: "3C" },
        { cognome: "COSTABLOZ", nome: "Giorgia", classe: "3C" },
        { cognome: "CUMINO", nome: "Lucia", classe: "3C" },
        { cognome: "EPICOCO", nome: "Angelica", classe: "3C" },
        { cognome: "MERLET", nome: "Cedric", classe: "3C" },
        { cognome: "PALMISANO", nome: "Clarissa", classe: "3C" },
        { cognome: "TARTIN", nome: "Zoe", classe: "3C" },
        { cognome: "CHIADO'", nome: "Diego", classe: "4A" },
        { cognome: "COMIOTTO", nome: "Lucia", classe: "4A" },
        { cognome: "CONTA", nome: "Giovanni", classe: "4A" },
        { cognome: "CROCE", nome: "Giacomo", classe: "4A" },
        { cognome: "DANNA", nome: "Gioele", classe: "4A" },
        { cognome: "DI TRIA", nome: "Alice", classe: "4A" },
        { cognome: "MANCUSO", nome: "Gaia", classe: "4A" },
        { cognome: "MARCIANO", nome: "Alberto", classe: "4A" },
        { cognome: "MENALDINO", nome: "Moreno", classe: "4A" },
        { cognome: "NAVARRETTA", nome: "Alexis Denis Fabien", classe: "4A" },
        { cognome: "OBERTO", nome: "Debora", classe: "4A" },
        { cognome: "TAPPELLA", nome: "Luca", classe: "4A" },
        { cognome: "TESSARIN", nome: "Sharon", classe: "4A" },
        { cognome: "VIOT", nome: "Cecilia", classe: "4A" },
        { cognome: "CHESSA", nome: "Samuele", classe: "4B" },
        { cognome: "FAVRE", nome: "Emilie", classe: "4B" },
        { cognome: "GIOVANNELLI T.", nome: "Tommaso", classe: "4B" },
        { cognome: "GORREX", nome: "Valerie", classe: "4B" },
        { cognome: "TEBANO", nome: "Serena", classe: "3P" },
        { cognome: "HACHEMAOUI", nome: "Slimane Raffaello", classe: "4B" },
        { cognome: "MEYNET", nome: "Riccardo", classe: "4B" },
        { cognome: "NICOLASI", nome: "Ginevra", classe: "4B" },
        { cognome: "SAVELLA", nome: "Ilaria", classe: "4B" },
        { cognome: "SERIO", nome: "Federica", classe: "4B" },
        { cognome: "CARRUOZZO", nome: "Amalia", classe: "5A", gruppo: "gr1" },
        { cognome: "CELESIA A.", nome: "Alessio", classe: "5A", gruppo: "gr2" },
        { cognome: "DE GATTIS", nome: "Eleonora", classe: "5A", gruppo: "gr2" },
        { cognome: "OBERT", nome: "Tommy", classe: "5A", gruppo: "gr2" },
        { cognome: "PETRIS", nome: "Maurizio", classe: "5A", gruppo: "gr2" },
        { cognome: "PICCOLI", nome: "Greta", classe: "5A", gruppo: "gr1" },
        { cognome: "PIGNATELLI", nome: "Maria Vittoria", classe: "5A", gruppo: "gr1" },
        { cognome: "RASO", nome: "Beatrice", classe: "5A", gruppo: "gr2" },
        { cognome: "SALVADORI", nome: "Emile", classe: "5A", gruppo: "gr2" },
        { cognome: "SORRENTI", nome: "Gabriele", classe: "5A", gruppo: "gr1" },
        { cognome: "VALLOMY", nome: "Etienne", classe: "5A", gruppo: "gr2" },
        { cognome: "VIGLIANO", nome: "Jacopo", classe: "5A", gruppo: "gr1" },
        { cognome: "CHREIM", nome: "Khadij√©", classe: "5B", gruppo: "gr1" },
        { cognome: "CORVO", nome: "Filippo", classe: "5B", gruppo: "gr1" },
        { cognome: "COTTINO", nome: "Jacqueline", classe: "5B", gruppo: "gr1" },
        { cognome: "KOUROUMA", nome: "Nora", classe: "5B", gruppo: "gr2" },
        { cognome: "LINTY", nome: "Alys", classe: "5B", gruppo: "gr1" },
        { cognome: "MARGUERETTAZ", nome: "Greta", classe: "5B", gruppo: "gr2" },
        { cognome: "MILLERY", nome: "Mathieu", classe: "5B", gruppo: "gr2" },
        { cognome: "RABAGLIO", nome: "Filippo", classe: "5B", gruppo: "gr1" }
    ];

    let filtroDinner=null, filtroClasse='Tutte';

    function updateClock() {
        const ora = new Date();
        const h = ora.getHours();
        const m = ora.getMinutes();
        const s = ora.getSeconds();
        const timeString = `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
        document.getElementById('digitalClock').innerText = timeString;

        const clockBox = document.querySelector('.clock-container');
        const totaleMinuti = (h * 60) + m;

        clockBox.classList.remove('status-waiting', 'status-dinner1', 'status-dinner2');
        if (totaleMinuti < 1110) clockBox.classList.add('status-waiting'); // Prima delle 18:30
        else if (totaleMinuti < 1155) clockBox.classList.add('status-dinner1'); // 18:30 - 19:14
        else clockBox.classList.add('status-dinner2'); // Dalle 19:15
    }

    function init(){
        const d=new Date(), g=d.getDay();
        
        // Formattazione Data
        const opzioni = { weekday: 'long', day: 'numeric', month: 'long' };
        let dataStr = d.toLocaleDateString('it-IT', opzioni);
        document.getElementById('todayDate').innerText = dataStr.charAt(0).toUpperCase() + dataStr.slice(1);

        // Orologio
        updateClock();
        setInterval(updateClock, 1000);

        if(g >= 1 && g <= 4) document.getElementById('day-'+g).classList.add('active-day');

        const tagList=document.getElementById('tagList');
        [...new Set(studenti.map(s=>s.classe))].sort().forEach(c=>{
            let t=document.createElement('div');
            t.className='tag'; t.id='tag-'+c; t.innerText=c;
            t.onclick=()=>setClasse(c);
            tagList.appendChild(t);
        });

        const lista=document.getElementById('listaStudenti');
        studenti.forEach(s=>{
            let r=document.createElement('div');
            r.className='student-row';
            r.dataset.classe=s.classe; 
            r.dataset.cognome=s.cognome; 
            r.dataset.nome=s.cognome+' '+s.nome;
            r.dataset.gruppo=s.gruppo || "";
            
            r.innerHTML=`<div class="name"><b>${s.cognome}</b> ${s.nome} ${s.gruppo ? `<span class="group-badge">${s.gruppo}</span>` : ''}</div><div>${s.classe}</div>`;
            r.onclick=()=>{ r.classList.toggle('assente'); aggiornaContatori(); };
            lista.appendChild(r);
        });
        assenzeAutomatiche(g);
        aggiornaContatori();
    }

    function assenzeAutomatiche(g){
        const d = new Date();
        const oggiStr = d.toLocaleDateString('it-IT', {day:'2-digit', month:'2-digit', year:'numeric'});
        const gruppoAssenteOggi = CALENDARIO_GRUPPI[oggiStr];
        document.querySelectorAll('.student-row').forEach(r=>{
            if(ASSENTI_CLASSI[g]?.includes(r.dataset.classe)) r.classList.add('assente');
            if(ASSENTI_PERMESSO[g]?.includes(r.dataset.cognome)) r.classList.add('assente');
            if(gruppoAssenteOggi && r.dataset.gruppo === gruppoAssenteOggi) r.classList.add('assente');
        });
    }

    function aggiornaContatori(){
        let p1=0, p2=0;
        document.querySelectorAll('.student-row').forEach(r=>{
            if(!r.classList.contains('assente')){
                let t=turnoStudente(r.dataset.classe,r.dataset.cognome);
                if(t===1) p1++; else p2++;
            }
        });
        document.getElementById('count1').innerText = p1;
        document.getElementById('count2').innerText = p2;
        document.getElementById('countTot').innerText = p1 + p2 + 4;
    }

    function resetRicerca() {
        const input = document.getElementById('searchInput');
        input.value = '';
        applicaFiltri();
        input.focus();
    }

    function turnoStudente(cl,cognome){
        if(OVERRIDE_TURNO_2.includes(cognome)) return 2;
        if(TURNI_BASE[1].includes(cl)) return 1;
        return 2;
    }

    function applicaFiltri(){
        const s=searchInput.value.toLowerCase();
        document.querySelectorAll('.student-row').forEach(r=>{
            let okS=r.innerText.toLowerCase().includes(s);
            let t=turnoStudente(r.dataset.classe,r.dataset.cognome);
            let okD=filtroDinner?filtroDinner===t:true;
            let okC=filtroClasse==='Tutte'||r.dataset.classe===filtroClasse;
            r.style.display=(okS&&okD&&okC)?'flex':'none';
        });
    }

    function setTurno(n){
        filtroDinner=filtroDinner===n?null:n;
        filtroClasse='Tutte';
        document.querySelectorAll('.btn').forEach(b=>b.classList.remove('active'));
        if(filtroDinner)document.getElementById('btn-d'+n).classList.add('active');
        applicaFiltri();
    }

    function setClasse(c){
        filtroClasse=c; filtroDinner=null;
        document.querySelectorAll('.tag').forEach(t=>t.classList.remove('active'));
        document.getElementById(c==='Tutte'?'tag-all':'tag-'+c).classList.add('active');
        applicaFiltri();
    }

    function generaPopUpStampa() {
        let a1=0, p1=0, a2=0, p2=0, n1=[], n2=[];
        document.querySelectorAll('.student-row').forEach(r=>{
            let t=turnoStudente(r.dataset.classe,r.dataset.cognome);
            let a=r.classList.contains('assente');
            if(t===1){ a?(a1++,n1.push(r.dataset.nome)):p1++; }
            if(t===2){ a?(a2++,n2.push(r.dataset.nome)):p2++; }
        });

        const dataStampa = document.getElementById('todayDate').innerText;
        const d = new Date(), g = d.getDay();
        const testiPermessi = {
            1: "LAB 2IeFP + PERMESSI: Tessarin no dinner; Casalicchio h 18; Pignatelli, Menaldino, Chessa h 20",
            2: "LAB 5A/5B + PERMESSI: Chen, Commod, Epicoco no dinner; Casalicchio, Clerin h 18; Lazier h 20",
            3: "LAB 2B + PERMESSI: Berruti S., D'Agostino, Epicoco, Giovannelli P. no dinner; Casalicchio h 18; Saitta h 19; Pignatelli, Chessa h 20",
            4: "LAB 2A + PERMESSI: Berruti A., Chen, Epicoco no dinner; Casalicchio, Clerin h 18; Menaldino, Lunardi, Chessa h 20"
        };
        const notaGiornoCorrente = testiPermessi[g] || "";

        const popup = window.open('', '_blank', 'width=900,height=800');
        popup.document.write(`
            <html>
            <head>
                <title>Stampa Conteggi</title>
                <style>
                    body { font-family: sans-serif; padding: 40px; color: #000; }
                    h2 { text-align: center; text-transform: uppercase; }
                    .date { text-align: center; font-size: 1.2em; }
                    .day-container-print { text-align: center; margin: 20px 0; }
                    .editable-notes { width: 100%; border: 1px dashed #ccc; font-size: 1.1em; font-weight: bold; text-align: center; text-transform: uppercase; padding: 10px; }
                    .section { margin-bottom: 30px; border-left: 6px solid #333; padding-left: 20px; }
                    .stats-row { display: flex; gap: 20px; align-items: center; }
                    input { font-size: 1.5em; font-weight: bold; width: 60px; border: none; border-bottom: 2px solid #000; text-align: center; }
                    .nomi { font-size: 0.8em; color: #555; font-style: italic; margin-top: 5px; }
                    .no-print { margin-top: 30px; display: flex; justify-content: center; }
                    @media print { .no-print { display: none; } .editable-notes { border: none; } }
                </style>
            </head>
            <body>
                <h2>Conteggi Dinner</h2>
                <div class="date">${dataStampa}</div>
                <div class="day-container-print"><textarea class="editable-notes" rows="2">${notaGiornoCorrente}</textarea></div>
                <div class="section">
                    <h3>1¬∞ DINNER ore 18:30 (Classi: 1A, 1B, 1P, 2A, 2B, 2P, 3P)</h3>
                    <div class="stats-row">
                        <span>Assenti: <input type="number" value="${a1}"></span>
                        <span>Presenti: <input type="number" value="${p1}"></span>
                        <span>+ EDU: <input type="number" value=" "></span>
                    </div>
                    <div class="nomi">Esclusi: ${n1.length ? n1.join(', ') : 'Nessuno'}</div>
                </div>
                <div class="section">
                    <h3>2¬∞ DINNER ore 19:15 (3A, 3B, 3C, 4A, 4B, 5A, 5B)</h3>
                    <div class="stats-row">
                        <span>Assenti: <input type="number" value="${a2}"></span>
                        <span>Presenti: <input type="number" value="${p2}"></span>
                        <span>+ EDU: <input type="number" value=" "></span>
                    </div>
                    <div class="nomi">Esclusi: ${n2.length ? n2.join(', ') : 'Nessuno'}</div>
                </div>
                <div class="no-print"><button onclick="window.print()" style="padding:15px 50px; background:#27ae60; color:white; font-weight:bold; border-radius:80px; border:none; cursor:pointer;">STAMPA </button></div>
            </body>
            </html>
        `);
        popup.document.close();
    }

    init();
</script>
</body>
</html>
