<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Presenze Dinner</title>
    <style>
        body {
            font-family: 'Bahnschrift', sans-serif;
            margin: 10px;
            padding: 30px;
            background-color: #d6efff;
        }
        .container {
            display: flex;
            justify-content: space-between;
            margin-top: 0px;
        }
        .box {
            width: 50%;
            padding: 30px;
            border-radius: 60px;
        }
        .box-left {
            background-color: #f8f8bd;
            border: 1px solid #ccc;
        }
        .box-right {
            background-color: #e3fac3;
            border: 1px solid #ccc;
        }
        .box-pink {
            font-size: 1.2em;
            display: flex;
            background-color: pink;
            padding: 30px;
            border-radius: 40px;
            border: 1px solid #ccc;
        }
        .DAY-limegreen { color: limegreen; font-weight: bold; }
        .DAY-mediumpurple { color: mediumpurple; font-weight: bold; }
        .DAY-deepskyblue { color: deepskyblue; font-weight: bold; }
        .DAY-mediumvioletred { color: mediumvioletred; font-weight: bold; }
        .DAY-brown { color: brown; font-weight: bold; }

        .column-left, .column-center, .column-right { flex: 1; }
        .column-right {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        button {
            padding: 50px 50px;
            background-color: #f5e7f8;
            border: 1px solid #ccc;
            border-radius: 20px;
            cursor: pointer;
        }

        .box-orange {
            background-color: #ffb55c;
            font-size: 1.3em;
            display: flex;
            padding: 30px;
            border-radius: 40px;
        }
        .box-blue {
            background-color: #add8e6;
            font-size: 1.2em;
            display: flex;
            padding: 30px;
            border-radius: 40px;
            margin-bottom: 0px;
        }
        h2 { font-weight: bold; margin: 0 50 10px; }
        table { width: 100%; margin-top: 0px; border-collapse: collapse; }
        th, td { border: 1px solid #c6c1c1; padding: 5px; text-align: center; }
        .date-display {
            text-align: center;
            font-weight: bold;
            font-size: 2.5em;
            margin-top: 20px;
        }
        .red-bold { color: red; font-weight: bold; font-size: 1.6em; }
        .green-bold { color: green; font-weight: bold; font-size: 1.6em; }
    </style>
</head>
<body>
    <h1 style="text-align:center;">Presenze Dinner</h1>
    
    <div class="date-display" id="current-date"></div><br>

    <div class="box-pink">
        <div class="column-left">
            <strong>Permessi Permanenti NODinner/NORientro:</strong><br>
            <span class="DAY-brown">LUN</span>: TESSARIN -NOR<br>
            <span class="DAY-brown">MAR</span>: CASALICCHIO(18), CLERIN(18), CHEVRERE -NOR<br>
            <span class="DAY-brown">MER</span>: CASALICCHIO(18)<br>
            <span class="DAY-brown">GIO</span>: CASALICCHIO(18)<br> 
        </div>
        <div class="column-center">
            <strong>Classi in Laboratorio, dinner ore 18:00:</strong><br>
            <span class="DAY-limegreen">Luned√¨</span> 2P <br>
            <span class="DAY-mediumpurple">Marted√¨</span> 5A-B <br>
            <span class="DAY-deepskyblue">Mercoled√¨</span> 2B <br>
            <span class="DAY-mediumvioletred">Gioved√¨</span> 2A <br>
        </div>
        <div class="column-right">
            <button id="lista_assenti_dinner">Conteggi</button>
        </div>
    </div>
    
    
        <!-- contenuto tasto conteggi  -->
    
    
  <script>
      
document.getElementById('lista_assenti_dinner').addEventListener('click', function() {
    const assenti = [];
    const checkboxes = document.querySelectorAll('input[type="checkbox"]');

    checkboxes.forEach(function(checkbox) {
        if (checkbox.checked) {
            const row = checkbox.closest('tr');
            const cognome = row.cells[0].innerText;
            const nome = row.cells[1].innerText;
            const classe = row.cells[2].innerText;
            const ppLabInfo = row.cells[4].innerText;
            
            let pp = '';
            let lab = '';
            
            if (ppLabInfo.includes('PP') && ppLabInfo.includes('lab')) {
                pp = 'PP';
                lab = ' Lab';
            } else if (ppLabInfo.includes('PP')) {
                pp = 'PP';
            } else if (ppLabInfo.includes('lab')) {
                lab = ' Lab';
            }

            assenti.push({ nome: cognome + ' ' + nome, classe: classe, XPP: pp, XLab: lab });
        }
    });

    // CREAZIONE POPUP
    const popup = window.open('', 'Popup', 'width=800,height=600');
    popup.document.write(`
        <html>
            <head>
                <title>Conteggi Dinner</title>
                <style>
                    body { font-family: 'Bahnschrift', sans-serif; margin: 20px; }
                    h1 { text-align: center; }
                    ul { padding-left: 20px; }
                    button { background-color: #4CAF50; color: white; border: none; padding: 10px 20px; cursor: pointer; font-size: 1.2em; margin-top: 20px; display: block; margin-left: auto; margin-right: auto; }
                    button:hover { background-color: #45a049; }
                    .date { font-size: 1.5em; font-weight: bold; text-align: center; }
                    .details { margin-top: 20px; text-align: center; font-size: 1.2em; }
                    .list-container { margin-top: 20px; padding-left: 40px; }
                    input[type="number"] { width: 60px; text-align: center; font-size: 1.2em; border-radius: 10px; }
                    
                    input[type="number"]::-webkit-outer-spin-button,
                    input[type="number"]::-webkit-inner-spin-button {
                        -webkit-appearance: none;
                        margin: 0;
                    }
                    input[type="number"] {
                        -moz-appearance: textfield;
                    }
                </style>
            </head>
            <body>
                <h1>Conteggi Dinner</h1>
                <div class="date" id="popup-date"></div>
                <div class="details">
                    <h2>Laboratori LUN 2FP, MAR 5A e 5B, MER 2B, GIO 2A</h2>
                    <p>
                        Dinner_0 ore 18:00 covittori totali <input type="number" id="assentiLab" readonly> +CASALICCHIO
                        </p>
                    <p>
                        Dinner_1 ore 18:30 classi 1A, 1B, 1P, 2A, 2B, 2P, 3P:<br>
                        assenti <input type="number" id="assenti1" readonly> 
                        presenti <input type="number" id="presenti1" readonly> 
                        + EDUCATORI <input type="number" id="edu1" max="99" min="0">
                    </p>
                    <p>
                        Dinner_2 ore 19:15 classi 3A, 3B, 3C, 4A, 4B, 5A, 5B:<br>
                        assenti <input type="number" id="assenti2" readonly>
                        presenti <input type="number" id="presenti2" readonly> 
                        + EDUCATORI <input type="number" id="edu2" max="99" min="0">
                    </p>
                </div>
                <div class="list-container">
                    
                    <h2>Esclusi dai turni 18:30 / 19:15 causa laboratorio, assenza, permesso o altro:</h2>
                    <ul id="assenti-list"></ul>
                </div>
                <button onclick="window.print()">STAMPA</button>
            </body>
        </html>
    `);

    const listContainer = popup.document.getElementById('assenti-list');
    const dateContainer = popup.document.getElementById('popup-date');

    // Data
    const oggi = new Date();
    const options = { weekday: 'long', day: '2-digit', month: 'long' };
    const dataFormattata = oggi.toLocaleDateString('it-IT', options);
    dateContainer.textContent = `Oggi √® ${dataFormattata}`;

    // Lista assenti
    if (assenti.length > 0) {
        assenti.forEach(function(persona, index) {
            let infoPP = persona.XPP ? `${persona.XPP}` : '';
            let infoLab = persona.XLab ? `${persona.XLab}` : '';
            const li = popup.document.createElement('li');
            li.textContent = `${index + 1}. ${persona.nome} ${persona.classe} - ${infoPP} ${infoLab}`;
            listContainer.appendChild(li);
        });
    } else {
        const li = popup.document.createElement('li');
        li.textContent = 'Nessun risultato';
        listContainer.appendChild(li);
    }

    // ---- CALCOLO PRESENTI/ASSENTI ----
    function calcolaConteggi() {
        const checkboxesDinner1 = document.querySelectorAll('#form1 input[type="checkbox"]');
        const checkboxesDinner2 = document.querySelectorAll('#form2 input[type="checkbox"]');

        let presenti1 = 0, assenti1 = 0;
        checkboxesDinner1.forEach(cb => cb.checked ? assenti1++ : presenti1++);

        let presenti2 = 0, assenti2 = 0;
        checkboxesDinner2.forEach(cb => cb.checked ? assenti2++ : presenti2++);

        popup.document.getElementById('presenti1').value = presenti1;
        popup.document.getElementById('assenti1').value = assenti1;

        popup.document.getElementById('presenti2').value = presenti2;
        popup.document.getElementById('assenti2').value = assenti2;

        // ---- CALCOLO DINNER LAB ----
        let giorno = oggi.getDay(); // 1=luned√¨, 2=marted√¨, 3=mercoled√¨, 4=gioved√¨
        let classiLab = [];
        if (giorno === 1) classiLab = ["2P"];
        if (giorno === 2) classiLab = ["5A", "5B"];
        if (giorno === 3) classiLab = ["2B"];
        if (giorno === 4) classiLab = ["2A"];

        let presentiLab = 0, assentiLab = 0;
        checkboxes.forEach(cb => {
            const row = cb.closest('tr');
            const classe = row.cells[2].innerText.trim();
            if (classiLab.includes(classe)) {
                if (cb.checked) assentiLab++;
                else presentiLab++;
            }
        });

        popup.document.getElementById('assentiLab').value = assentiLab;
        popup.document.getElementById('presentiLab').value = presentiLab;
    }

    calcolaConteggi();
});
      
</script>


    
    
<!-- ... TABELLE DELLE CLASSI  -->
    
     <div class="container">
        <div class="box box-left">
            <h2>Primo Dinner ore 18:30 <br> Classi: 1A, 1B, 1P, 2A, 2B, 2P, 3P</h2>
            <div class="header">
                <p id="result1" style="margin-left: 100px;"></p>
            </div>
            <form id="form1">
                <table>
                    <tr>
                        
                        <th>COGNOME</th>
                        <th>NOME</th>
                        <th>CLASSE</th>
                        <th>ASSENTE</th>
                    </tr>
                    
                    
                <!-- Classe 1A -->
                
    <tr><td>COMMOD</td><td>Gaia</td><td>1A</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>GASPARD</td><td>Thierry</td><td>1A</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>JANS</td><td>Giada</td><td>1A</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>OBETTI</td><td>Virginia</td><td>1A</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>PETTORALI</td><td>Matilde</td><td>1A</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>ZIGGIOTTO</td><td>Beatrice</td><td>1A</td><td><input type="checkbox"></td><td></td></tr>
                
                <!-- Classe 1B -->
                    
    <tr><td>BOMBONATO</td><td>Francesco</td><td>1B</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>DATTRINO</td><td>Nicolas</td><td>1B</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>GIOVANDO</td><td>Caterina</td><td>1B</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>LUNARDI</td><td>Filippo</td><td>1B</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>POUJOL</td><td>Chiara</td><td>1B</td><td><input type="checkbox"></td><td></td></tr>
    
                    <tr><td>QUERIO GIANETTO</td><td>Giorgio</td><td>1B</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>SALVI</td><td>Sophie</td><td>1B</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>SCHIRRU</td><td>Didier F√©licien Herv√©</td><td>1B</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>SILVANI</td><td>Amelie</td><td>1B</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>VILARDO</td><td>Gabriele</td><td>1B</td><td><input type="checkbox"></td><td></td></tr>
                                
                <!-- Classe 1P -->
                                                    
    <tr><td>BOUKHRIS</td><td>Chams Jacopo</td><td>1P</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>CHABLOZ</td><td>Annette</td><td>1P</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>CHEVRERE</td><td>Bruno</td><td>1P</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>D'AGOSTINO</td><td>Domenico</td><td>1P</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>FURLAN</td><td>Alessandro</td><td>1P</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>GIOVANNELLI P.</td><td>Pietro</td><td>1P</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>GUIZZETTI RINCON</td><td>Francisco Andres</td><td>1P</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>LAI</td><td>Stefano</td><td>1P</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>LAZIER</td><td>Francesco</td><td>1P</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>PAONESSA</td><td>Leonardo</td><td>1P</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>VINCENT</td><td>Thomas</td><td>1P</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>RUSCI DI LUCA</td><td>Greta</td><td>1P</td><td><input type="checkbox"></td><td></td></tr>
             
    
                <!-- Classe 2A --> 
                    
    <tr style="color:green;"><td>BARAVALLE</td><td>Andrea</td><td>2A</td><td><input type="checkbox"></td><td>GI</td></tr>
    <tr style="color:green;"><td>BERTOT</td><td>Manuele</td><td>2A</td><td><input type="checkbox"></td><td>GI</td></tr>
    <tr style="color:green;"><td>BUZZI</td><td>Alessandro</td><td>2A</td><td><input type="checkbox"></td><td>GI</td></tr>
    <tr style="color:green;"><td>CASTELLANO</td><td>Martina</td><td>2A</td><td><input type="checkbox"></td><td>GI</td></tr>
    <tr style="color:green;"><td>DA FRE</td><td>Gaia</td><td>2A</td><td><input type="checkbox"></td><td>GI</td></tr>
    <tr style="color:green;"><td>DE GASPER</td><td>Lara</td><td>2A</td><td><input type="checkbox"></td><td>GI</td></tr>
    <tr style="color:green;"><td>GARCIA</td><td>Luis Alberto</td><td>2A</td><td><input type="checkbox"></td><td>GI</td></tr>
    <tr style="color:green;"><td>HERESAZ</td><td>Alyce</td><td>2A</td><td><input type="checkbox"></td><td>GI</td></tr>
    <tr style="color:green;"><td>PENNARD</td><td>Serena</td><td>2A</td><td><input type="checkbox"></td><td>GI</td></tr>
    <tr style="color:green;"><td>SAITTA</td><td>Asia</td><td>2A</td><td><input type="checkbox"></td><td>GI</td></tr>
               
                <!-- Classe 2B --> 
                    
    <tr style="color:blue;"><td>CHEN</td><td>Michael Jianhao</td><td>2B</td><td><input type="checkbox"></td><td>ME</td></tr>
    <tr style="color:blue;"><td>DELLAQUILA</td><td>Gabriele</td><td>2B</td><td><input type="checkbox"></td><td>ME</td></tr>
    <tr style="color:blue;"><td>DUNAND</td><td>Audrey</td><td>2B</td><td><input type="checkbox"></td><td>ME</td></tr>
    <tr style="color:blue;"><td>GHILARDINI</td><td>Leonardo</td><td>2B</td><td><input type="checkbox"></td><td>ME</td></tr>
    <tr style="color:blue;"><td>MAINO</td><td>Giada</td><td>2B</td><td><input type="checkbox"></td><td>ME</td></tr>
    <tr style="color:blue;"><td>MISERENDINO</td><td>Ludovica</td><td>2B</td><td><input type="checkbox"></td><td>ME</td></tr>
    <tr style="color:blue;"><td>MOUNIM</td><td>Yahya</td><td>2B</td><td><input type="checkbox"></td><td>ME</td></tr>
    <tr style="color:blue;"><td>PEZZOLI</td><td>Niccol√≤</td><td>2B</td><td><input type="checkbox"></td><td>ME</td></tr>
    <tr style="color:blue;"><td>TACCONE</td><td>Nicholas</td><td>2B</td><td><input type="checkbox"></td><td>ME</td></tr>
                    
                <!-- Classe 2P -->                     
                    
    <tr style="color:red;"><td>BERRIAD</td><td>Thierry</td><td>2P</td><td><input type="checkbox"></td><td>LU</td></tr>
    <tr style="color:red;"><td>BERRUTI A.</td><td>Andrea</td><td>2P</td><td><input type="checkbox"></td><td>LU</td></tr>
    <tr style="color:red;"><td>BERRUTI S.</td><td>Stefano</td><td>2P</td><td><input type="checkbox"></td><td>LU</td></tr>
    <tr style="color:red;"><td>CASALICCHIO</td><td>Nahuel</td><td>2P</td><td><input type="checkbox"></td><td>LU</td></tr>
    <tr style="color:red;"><td>CLERIN</td><td>Pietro</td><td>2P</td><td><input type="checkbox"></td><td>LU</td></tr>
    <tr style="color:red;"><td>DONZEL</td><td>Elodie</td><td>2P</td><td><input type="checkbox"></td><td>LU</td></tr>
    <tr style="color:red;"><td>GENS</td><td>Aaron</td><td>2P</td><td><input type="checkbox"></td><td>LU</td></tr>
    <tr style="color:red;"><td>HERRERA</td><td>Alexander</td><td>2P</td><td><input type="checkbox"></td><td>LU</td></tr>
    <tr style="color:red;"><td>MONTERO</td><td>Karen</td><td>2P</td><td><input type="checkbox"></td><td>LU</td></tr>
    <tr style="color:red;"><td>PERRIN</td><td>Annie</td><td>2P</td><td><input type="checkbox"></td><td>LU</td></tr>
    <tr style="color:red;"><td>STEVENIN</td><td>Joelle</td><td>2P</td><td><input type="checkbox"></td><td>LU</td></tr>
    <tr style="color:red;"><td>TORTORELLI C.</td><td>Carlotta</td><td>2P</td><td><input type="checkbox"></td><td>LU</td></tr>
    <tr style="color:red;"><td>TORTORELLI G.</td><td>Greta</td><td>2P</td><td><input type="checkbox"></td><td>LU</td></tr>
                    
                  <!-- Classe 3P -->                     
                    
    <tr><td>CONSOL</td><td>Gaia</td><td>3P</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>COSTANZA</td><td>Marcello</td><td>3P</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>LAGOMARSINI</td><td>Michele</td><td>3P</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>LLESHI</td><td>Gabriele</td><td>3P</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>MARRERO</td><td>Lewis</td><td>3P</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>RONCO</td><td>Angelica</td><td>3P</td><td><input type="checkbox"></td><td></td></tr>
                                
                    
   
             
                </table><br>
            </form>
        </div>
  
        <!-- Box Verde -->
        <div class="box box-right">
            <h2>Secondo Dinner ore 19:15 <br> Classi 3A, 3B, 3C, 4A, 4B, 5A, 5B</h2>
            <div class="header">
                <p id="result2" style="margin-left: 100px;"></p>
            </div>
            <form id="form2">
                <table>
                    <tr>
                         
                        <th>COGNOME</th>
                        <th>NOME</th>
                        <th>CLASSE</th>
                        <th>ASSENTE</th>
                    </tr>
                        
                          
                    <!-- Classe 3A -->
                    
    <tr><td>CATTARINUSSI</td><td>Samuele</td><td>3A</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>FLORIAN</td><td>Gabriele</td><td>3A</td><td><input type="checkbox"></td><td>TH</td></tr>
    <tr><td>MARANGELO</td><td>Giulio</td><td>3A</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>PEAQUIN</td><td>Linda</td><td>3A</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>ZOPPO</td><td>Rodrigue</td><td>3A</td><td><input type="checkbox"></td><td></td></tr>
  
                    <!-- Classe 3B -->
                    
    <tr><td>BLANCHET</td><td>Magalie</td><td>3B</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>BOGGIA</td><td>Vittoria</td><td>3B</td><td><input type="checkbox"></td><td></td></tr>         
    <tr><td>CIRINA</td><td>Lorenzo</td><td>3B</td><td><input type="checkbox"></td><td></td></tr>         
    <tr><td>DUBLANC</td><td>Nicole</td><td>3B</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>GRANATA</td><td>Gabriele</td><td>3B</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>PRUTEANU</td><td>Mihai Giuliano</td><td>1B</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>TRIOLO</td><td>Eleonora</td><td>3B</td><td><input type="checkbox"></td><td>TH</td></tr>
  
                    <!-- Classe 3C -->               
                    
    <tr><td>CELESIA M.</td><td>Marta</td><td>3C</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>CUMINO</td><td>Lucia</td><td>3C</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>EPICOCO</td><td>Angelica</td><td>3C</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>MERLET</td><td>Cedric</td><td>3C</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>PALMISANO</td><td>Clarissa</td><td>3C</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>TARTIN</td><td>Zoe</td><td>3C</td><td><input type="checkbox"></td><td></td></tr>
  
                    <!-- Classe 4A -->                
                    
    <tr><td>CHIADO'</td><td>Diego</td><td>4A</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>COMIOTTO</td><td>Lucia</td><td>4A</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>CONTA</td><td>Giovanni</td><td>4A</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>CROCE</td><td>Giacomo</td><td>4A</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>DANNA</td><td>Gioele</td><td>4A</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>DI TRIA</td><td>Alice</td><td>4A</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>MANCUSO</td><td>Gaia</td><td>4A</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>MARCIANO</td><td>Alberto</td><td>4A</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>MENALDINO</td><td>Moreno</td><td>4A</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>NAVARRETTA</td><td>Alexis Denis Fabien</td><td>4A</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>OBERTO</td><td>Debora</td><td>4A</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>TAPPELLA</td><td>Luca</td><td>4A</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>TESSARIN</td><td>Sharon</td><td>4A</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>VIOT</td><td>Cecilia</td><td>4A</td><td><input type="checkbox"></td><td></td></tr>
 
                    <!-- Classe 4B -->
                    
    <tr><td>CHESSA</td><td>Samuele</td><td>4B</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>FAVRE</td><td>Emilie</td><td>4B</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>GIOVANNELLI T.</td><td>Tommaso</td><td>4B</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>GORREX</td><td>Valerie</td><td>4B</td><td><input type="checkbox"></td><td></td></tr>
            
    <tr style="color:orange;"><td>TEBANO</td><td>Serena</td><td>3P</td><td><input type="checkbox"></td><td></td></tr>             
                
    <tr><td>HACHEMAOUI</td><td>Slimane Raffaello</td><td>4B</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>MEYNET</td><td>Riccardo</td><td>4B</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>NICOLASI</td><td>Ginevra</td><td>4B</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>SAVELLA</td><td>Ilaria</td><td>4B</td><td><input type="checkbox"></td><td></td></tr>
    <tr><td>SERIO</td><td>Federica</td><td>4B</td><td><input type="checkbox"></td><td></td></tr>
 
                   
                    <!-- Classe 5A -->
                    
    <tr style="color:mediumpurple;"><td>CARRUOZZO A.</td><td>Amalia</td><td>5A</td><td><input type="checkbox"></td><td>MA-1</td></tr>
    <tr style="color:mediumpurple;"><td>CELESIA A.</td><td>Alessio</td><td>5A</td><td><input type="checkbox"></td><td>MA-2</td></tr>
    <tr style="color:mediumpurple;"><td>DE GATTIS</td><td>Eleonora</td><td>5A</td><td><input type="checkbox"></td><td>MA-2</td></tr>
    <tr style="color:mediumpurple;"><td>OBERT</td><td>Tommy</td><td>5A</td><td><input type="checkbox"></td><td>MA-2</td></tr>
    <tr style="color:mediumpurple;"><td>PETRIS</td><td>Maurizio</td><td>5A</td><td><input type="checkbox"></td><td>MA-2</td></tr>
    <tr style="color:mediumpurple;"><td>PICCOLI</td><td>Greta</td><td>5A</td><td><input type="checkbox"></td><td>MA-1</td></tr>
    <tr style="color:mediumpurple;"><td>PIGNATELLI</td><td>Maria Vittoria</td><td>5A</td><td><input type="checkbox"></td><td>MA-1</td></tr>
    <tr style="color:mediumpurple;"><td>RASO</td><td>Beatrice</td><td>5A</td><td><input type="checkbox"></td><td>MA-2</td></tr>
    <tr style="color:mediumpurple;"><td>SALVADORI</td><td>Emile</td><td>5A</td><td><input type="checkbox"></td><td>MA-2</td></tr>
    <tr style="color:mediumpurple;"><td>SORRENTI</td><td>Gabriele</td><td>5A</td><td><input type="checkbox"></td><td>MA-1</td></tr>
    <tr style="color:mediumpurple;"><td>VALLOMY</td><td>Etienne</td><td>5A</td><td><input type="checkbox"></td><td>MA-2</td></tr>
    <tr style="color:mediumpurple;"><td>VIGLIANO</td><td>Jacopo</td><td>5A</td><td><input type="checkbox"></td><td>MA-1</td></tr>

                    <!-- Classe 5B -->
                    
    <tr style="color:mediumpurple;"><td>CARRUOZZO V.</td><td>Virginia</td><td>5B</td><td><input type="checkbox"></td><td>MA-2</td></tr>
    <tr style="color:mediumpurple;"><td>CHREIM</td><td>Khadij√©</td><td>5B</td><td><input type="checkbox"></td><td>MA-1</td></tr>
    <tr style="color:mediumpurple;"><td>CORVO</td><td>Filippo</td><td>5B</td><td><input type="checkbox"></td><td>MA-1</td></tr>
    <tr style="color:mediumpurple;"><td>COTTINO</td><td>Jacqueline</td><td>5B</td><td><input type="checkbox"></td><td>MA-1</td></tr>
    <tr style="color:mediumpurple;"><td>KOURUMA</td><td>Nora</td><td>5B</td><td><input type="checkbox"></td><td>MA-2</td></tr>
    <tr style="color:mediumpurple;"><td>LINTY</td><td>Alys</td><td>5B</td><td><input type="checkbox"></td><td>MA-1</td></tr>
    <tr style="color:mediumpurple;"><td>MARGUERETTAZ</td><td>Greta</td><td>5B</td><td><input type="checkbox"></td><td>MA-2</td></tr>
    <tr style="color:mediumpurple;"><td>MILLERY</td><td>Mathieu</td><td>5B</td><td><input type="checkbox"></td><td>MA-2</td></tr>
    <tr style="color:mediumpurple;"><td>RABAGLIO</td><td>Filippo</td><td>5B</td><td><input type="checkbox"></td><td>MA-1</td></tr>
                                     
                </table>
        </form>
    </div>
 </div>

    <!-- SCRIPT PRINCIPALE FINALE -->
    
    <script>
    // =====================
    // CALENDARI 5AB
    // =====================
    const calendarioLab5AB_Q1 = { /* ... (tutte le date Q1 che ti ho dato) ... */ };
    const calendarioLab5AB_Q2 = { /* ... (tutte le date Q2 che ti ho dato) ... */ };

    // =====================
    // FUNZIONI SUPPORTO
    // =====================
    function mostraDataOdierna() {
        const oggi = new Date();
        const options = { weekday: 'long', day: '2-digit', month: 'long' };
        const dataFormattata = oggi.toLocaleDateString('it-IT', options);
        const giorno = dataFormattata.split(' ')[0];
        const giornoNum = oggi.getDate().toString().padStart(2, '0');
        const mese = oggi.toLocaleString('it-IT', { month: 'long' });
        document.getElementById('current-date').innerText =
            `Oggi √® ${giorno} ${giornoNum} ${mese}`;
    }

    function flaggaCheckbox(formId, classe) {
        const rows = document.querySelectorAll(`#${formId} tr`);
        rows.forEach(row => {
            if (row.cells[2].innerText === classe) {
                const checkbox = row.querySelector('input[type="checkbox"]');
                if (checkbox) checkbox.checked = true;
            }
        });
    }

    function flaggaCheckboxByCognome(formId, cognome) {
        const rows = document.querySelectorAll(`#${formId} tr`);
        rows.forEach(row => {
            if (row.cells[0].innerText === cognome) {
                const checkbox = row.querySelector('input[type="checkbox"]');
                if (checkbox) checkbox.checked = true;
            }
        });
    }

    function sommaFlag(formId) {
        const checkboxes = document.querySelectorAll(`#${formId} input[type="checkbox"]`);
        let flagCount = 0, presentCount = 0;
        checkboxes.forEach(cb => cb.checked ? flagCount++ : presentCount++);
        document.getElementById(`result${formId.slice(-1)}`).innerHTML =
            `Oggi in questo turno risultano <span class="red-bold">${flagCount}</span> assenti e <span class="green-bold">${presentCount}</span> presenti`;
    }

    function flaggaGruppo(formId, gruppo) {
        const rows = document.querySelectorAll(`#${formId} tr`);
        rows.forEach(row => {
            const info = row.cells[4]?.innerText.trim();
            if (info === gruppo) {
                const checkbox = row.querySelector('input[type="checkbox"]');
                if (checkbox) checkbox.checked = true;
            }
        });
    }

    function flaggaGruppoDaCalendario(formId) {
        const oggi = new Date();
        const giorno = oggi.getDate().toString().padStart(2, "0");
        const mese = (oggi.getMonth() + 1).toString().padStart(2, "0");
        const anno = oggi.getFullYear();
        const dataChiave = `${giorno}/${mese}/${anno}`;

        let gruppo = null;
        if (oggi < new Date("2026-02-01")) {
            gruppo = calendarioLab5AB_Q1[dataChiave];
        } else {
            gruppo = calendarioLab5AB_Q2[dataChiave];
        }

        if (gruppo) {
            flaggaGruppo(formId, gruppo);

            // Debug + legenda
            let debugBox = document.getElementById("debug-lab");
            if (!debugBox) {
                debugBox = document.createElement("div");
                debugBox.id = "debug-lab";
                debugBox.style.textAlign = "center";
                debugBox.style.fontWeight = "bold";
                debugBox.style.marginTop = "10px";
                document.querySelector("h1").after(debugBox);
            }
            debugBox.innerHTML = `
                üìå Oggi (${dataChiave}) √® stato selezionato 
                <span style="color:blue">${gruppo}</span> per la 5AB
                <div style="font-size:0.9em; color:#444; margin-top:5px;">
                    üîπ MA-1 = Gruppo 1 &nbsp;&nbsp; üîπ MA-2 = Gruppo 2
                </div>
            `;
        }
    }

    // =====================
    // FUNZIONE PRINCIPALE
    // =====================
        
                            <!-- florian e triolo SOLO fino al 6 ottobre -->
        
        
    function flaggaAssenti() {
        const oggi = new Date();
        const giorno = oggi.getDay(); // 0=Dom, 1=Lun, 2=Mar, ..., 5=Ven

        document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);

        if (giorno === 1) { // Luned√¨
            flaggaCheckbox('form1', '2P');
            flaggaCheckboxByCognome('form1', 'CASALICCHIO');
            flaggaCheckboxByCognome('form2', 'FLORIAN');
            flaggaCheckboxByCognome('form2', 'TRIOLO');
            flaggaCheckboxByCognome('form2', 'TESSARIN');
        } 
        else if (giorno === 2 || giorno === 5) { // Marted√¨ o Venerd√¨
            flaggaGruppoDaCalendario('form2');
            flaggaCheckboxByCognome('form1', 'CLERIN');
            flaggaCheckboxByCognome('form1', 'CASALICCHIO'); 
            flaggaCheckboxByCognome('form1', 'CHEVRERE');
            flaggaCheckboxByCognome('form2', 'FLORIAN');
            flaggaCheckboxByCognome('form2', 'TRIOLO');
        } 
        else if (giorno === 3) { // Mercoled√¨
            flaggaCheckbox('form1', '2B');
            flaggaCheckboxByCognome('form1', 'CASALICCHIO');
            flaggaCheckboxByCognome('form2', 'FLORIAN');
            flaggaCheckboxByCognome('form2', 'TRIOLO');
         
        } 
        else if (giorno === 4) { // Gioved√¨
            flaggaCheckbox('form1', '2A');
            flaggaCheckboxByCognome('form1', 'CLERIN');
            flaggaCheckboxByCognome('form1', 'CASALICCHIO');
            flaggaCheckboxByCognome('form2', 'FLORIAN');
            flaggaCheckboxByCognome('form2', 'TRIOLO');
        }

        sommaFlag('form1');
        sommaFlag('form2');
    }

    // =====================
    // AVVIO ALL'APERTURA
    // =====================
    mostraDataOdierna();
    flaggaAssenti();
    document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
        cb.addEventListener('change', function() {
            sommaFlag(cb.closest('form').id);
        });
    });
    </script>
</body>
</html>
